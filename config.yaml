# ========================= Data Settings =========================
data:
  data_dir: "data"              # Directory containing .npz files
  single_npz: null              # If set, train on a single .npz file only (overrides data_dir)
  norm_scope: "global"          # Normalization scope: "global" or "per_case"
  frame_stride: 2               # Frame downsampling interval (e.g., use every 2nd frame)

# ========================= Model Settings =========================
model:
  hidden_node: 128              # Hidden dimension for node GConvGRU
  hidden_elem: 128              # Hidden dimension for element GConvGRU
  K_node: 1                     # Chebyshev polynomial order for node graph convolution
  K_elem: 1                     # Chebyshev polynomial order for element graph convolution
  in_node_features: 12          # Node input feature dimension (fixed by data structure)

# ========================= Training Settings =========================
training:
  epochs: 800
  lr: 0.005
  batch_cases: 16               # Number of simulation cases per batch
  clip_norm: 0.5                # Gradient clipping norm (0 to disable)
  val_ratio: 0.1                # Fraction of cases used for validation (0 to disable)
  val_interval: 10              # Validate every N epochs
  save_best: true               # Save best model based on validation loss

# ========================= Loss Weights =========================
loss:
  lambda_s: 0.0                 # Weight for element stress loss
  lambda_lap: 0.0               # Weight for Laplacian smoothing loss on displacement
  lambda_rf2: 0.0               # Weight for global reaction force (RF2) loss
  use_smooth_l1: true           # Use Huber (Smooth L1) loss for stress instead of MSE

# ========================= Teacher Forcing =========================
teacher_forcing:
  k_steps: 100                  # Number of epochs to apply decaying teacher forcing
  p_start: 0.0                  # Initial teacher forcing probability

# ========================= Graph Construction =========================
graph:
  edge_mode_node: "abaqus"      # Node graph: "abaqus" (only element edges) or "complete"
  elem_adj_mode: "face"         # Element graph adjacency: "face", "node", or "none"
  s_prev_mode: "mean"           # Stress feedback to nodes: "mean", "rms", or "none"
  no_s_feedback: true           # If true, completely disable stress feedback

# ========================= Miscellaneous =========================
seed: 42
use_cuda: true                  # Use GPU if available
save_path: "checkpoints/joint_us_dual_rf2_batch16.pth"   # Final model save path
